<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>YEARN â€” base</title>
<style>
  :root { 
    --blob-size: 260px;  /* smaller blob */
  }

  html,body{
    height:100%;
    margin:0;
    background:#000;
    font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    color:#ddd;
  }

  /* background (NO movement) */
  #bg {
    position:fixed;
    inset:0;
    background-image: url('./assets/background.png');
    background-size: cover;
    background-position: center;
    opacity:0.95;
    z-index:0;
  }

  #stage {
    position:relative;
    z-index:1;
    height:100%;
    display:flex;
    align-items:center;
    justify-content:center;
    pointer-events:none;
  }

  /* smaller blob + breathing only */
  #blob {
    pointer-events:auto;
    width: var(--blob-size);
    height:auto;
    user-select:none;
    image-rendering:pixelated;
    transform-origin: 50% 50%;
    cursor:pointer;

    animation: breatheBlob 3.6s ease-in-out infinite;
    transition: transform 180ms ease, filter 200ms ease;
  }

  @keyframes breatheBlob {
    0%   { opacity:0.82; transform: scale(1); }
    45%  { opacity:1; transform: scale(1.03); }
    100% { opacity:0.82; transform: scale(1); }
  }

  /* New diagonal stretched effect */
  .stretched {
    transform: 
       perspective(600px)
       rotateZ(-4deg)
       rotateX(3deg)
       rotateY(-5deg)
       skew(-6deg, 4deg)
       scaleX(1.12) 
       scaleY(0.92)
       translate(-8px, -6px);
    filter: blur(1px) contrast(1.1) saturate(1.2);
    transition-duration: 140ms !important;
  }

  #notice {
    position:fixed;
    left:12px;
    bottom:12px;
    z-index: 3;
    background: rgba(0,0,0,0.45);
    border: 1px solid rgba(255,255,255,0.06);
    padding:10px 12px;
    border-radius:8px;
    font-size:13px;
    color:#f6f6f6;
  }
  #notice.hidden { display:none; }
</style>
</head>
<body>

<div id="bg"></div>

<div id="stage">
  <img id="blob" src="./assets/blob1.png" alt="blob">
</div>

<div id="notice" class="hidden">Loading assets...</div>

<script>
(function(){
  const blob = document.getElementById("blob");
  const notice = document.getElementById("notice");

  const assets = [
    "./assets/blob1.png",
    "./assets/blob2.png",
    "./assets/blob3.png",
    "./assets/background.png"
  ];

  // preload
  let loaded = 0, failed = [];

  assets.forEach(src => {
    const i = new Image();
    i.onload = () => {
      loaded++;
      if (loaded === assets.length) notice.classList.add("hidden");
    };
    i.onerror = () => {
      failed.push(src);
      loaded++;
      notice.textContent = "Failed: " + failed.join(", ");
    };
    i.src = src;
  });

  // animation loop
  const frames = [
    "./assets/blob1.png",
    "./assets/blob2.png",
    "./assets/blob3.png"
  ];

  let idx = 0;
  let interval = 600;
  let timer = setInterval(() => {
    idx = (idx + 1) % frames.length;
    blob.src = frames[idx];
  }, interval);

  // fast click stretch
  let clicks = [];
  const CLICK_WINDOW = 1200;
  const CLICK_REQ = 5;

  blob.addEventListener("click", () => {
    const now = Date.now();
    clicks.push(now);
    clicks = clicks.filter(t => now - t <= CLICK_WINDOW);

    // tiny feedback
    blob.style.transform = "scale(1.02)";
    setTimeout(()=> blob.style.transform = "", 90);

    if (clicks.length >= CLICK_REQ) {
      doStretch();
      clicks = [];
    }
  });

  function doStretch(){
    blob.classList.add("stretched");

    // speed frames briefly
    clearInterval(timer);
    timer = setInterval(() => {
      idx = (idx + 1) % frames.length;
      blob.src = frames[idx];
    }, 90);

    setTimeout(() => {
      blob.classList.remove("stretched");

      clearInterval(timer);
      timer = setInterval(() => {
        idx = (idx + 1) % frames.length;
        blob.src = frames[idx];
      }, interval);
    }, 160);
  }
})();
</script>

</body>
</html>
