<script>
window.onload = () => {
    let click1 = 0;
    let click2 = 0;

    const c1 = document.getElementById("cookie1");
    const c2 = document.getElementById("cookie2");
    const mask = document.getElementById("loadingMask");
    const jump = document.getElementById("jumpscare");

    if (!c1 || !c2 || !mask || !jump) {
        console.error("ERROR: One or more elements are missing in HTML.");
        return;
    }

    // ------------------------
    // COOKIE 1 – SMOOTHER CLICK
    // ------------------------
    c1.onclick = () => {
        click1++;

        c1.style.transition = "transform 0.12s cubic-bezier(.25,.8,.25,1)";
        c1.style.transform = "translate(-50%, -50%) scale(0.9)";
        setTimeout(() => {
            c1.style.transform = "translate(-50%, -50%) scale(1)";
        }, 120);

        if (click1 >= 5) {
            c1.style.display = "none";
            loadCookie2();
        }
    };


    // ------------------------
    // COOKIE 2 LOADING
    // ------------------------
    function loadCookie2() {
        c2.style.display = "block";
        mask.style.display = "block";
        mask.style.height = "100%";

        let progress = 100;

        function step() {
            progress -= 5;
            if (progress < 0) progress = 0;

            mask.style.height = progress + "%";

            if ([80, 50, 25].includes(progress)) {
                setTimeout(step, 120);
            } else if (progress > 0) {
                setTimeout(step, 25);
            } else {
                mask.style.display = "none";
            }
        }

        step();
    }


    // ------------------------
    // COOKIE 2 – ZOOM EFFECT
    // ------------------------
    c2.onclick = () => {
        if (mask.style.display === "block") return;

        click2++;

        const zoom = 1 + click2 * 0.03;
        c2.style.transform = `translate(-50%, -50%) scale(${zoom})`;

        if (click2 >= 10) {
            triggerJumpscare();
        }
    };


    // ------------------------
    // JUMPSCARE
    // ------------------------
    function triggerJumpscare() {
        c2.style.display = "none";
        jump.style.display = "block";

        requestAnimationFrame(() => {
            jump.animate(
                [
                    { transform: "scale(1)" },
                    { transform: "scale(3.5)" }
                ],
                {
                    duration: 90,
                    fill: "forwards"
                }
            );
        });
    }
};
</script>
